(this["webpackJsonppubs-map"]=this["webpackJsonppubs-map"]||[]).push([[0],{10:function(t,e,n){t.exports=n(25)},16:function(t,e,n){},25:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),c=n(8),r=n(1),u=n(2),i=n(4),p=n(3),s=n(5),l=(n(15),n(16),n(9)),d=n.n(l),m=n(6),h=n.n(m),y=function(t,e,n){return e/function(t,e){var n=t*(Math.PI/180);return 40075017*Math.cos(n)/Math.pow(2,e+8)}(t,n)},b={width:"100%",height:"100vh"},v=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(i.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(o)))).popup=new h.a.Popup,n.onLoad=function(){var t=n.props,e=t.center,a=t.accuracy,o=t.pubs;n.map.addSource("location",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:e}}]}}),n.map.addSource("pubs",{type:"geojson",data:o}),n.map.addLayer({id:"location",type:"circle",source:"location",paint:{"circle-color":"#2dd860"}}),n.map.addLayer({id:"locationHalo",type:"circle",source:"location",paint:{"circle-color":"rgba(45,216,96,.5)","circle-radius":{stops:[[8,y(e[1],a,8)],[9,y(e[1],a,9)],[10,y(e[1],a,10)],[11,y(e[1],a,11)],[12,y(e[1],a,12)],[13,y(e[1],a,13)],[14,y(e[1],a,14)],[15,y(e[1],a,15)],[16,y(e[1],a,16)],[17,y(e[1],a,17)],[18,y(e[1],a,18)],[19,y(e[1],a,19)],[20,y(e[1],a,20)],[22,y(e[1],a,22)]]}}}),n.map.addLayer({id:"pubs",type:"circle",source:"pubs",paint:{"circle-color":"#5c9ed8"}}),n.map.addLayer({id:"pubs-names",type:"symbol",source:"pubs",layout:{"text-field":"{name}","text-anchor":"bottom"}}),n.map.on("mousemove",n.onMouseMove)},n.onMouseMove=function(t){var e=n.map.queryRenderedFeatures(t.point,{layers:["pubs"]});if(e.length>0){var a=e[0].properties;n.popup.setLngLat(t.lngLat).setHTML("\n          <div>".concat(a.name,"</div>\n          <div>\u0442\u0435\u043b\u0435\u0444\u043e\u043d: ").concat(a.phone||a["contact:phone"],"</div>\n          <div>").concat(a.website||a["contact:website"],"</div>\n        ")).addTo(n.map)}},n}return Object(s.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this.props.center;h.a.accessToken="pk.eyJ1IjoiZGV2aWNlMjUiLCJhIjoiY2lzaGN3d2tiMDAxOTJ6bGYydDZrcHptdiJ9.UK55aUzBquqYns1AdnuTQg",this.map=new h.a.Map({container:"map",style:"mapbox://styles/mapbox/light-v9",center:t,zoom:9,minZoom:8}),this.map.on("load",this.onLoad)}},{key:"render",value:function(){return o.a.createElement("div",{id:"map",style:b})}}]),e}(a.PureComponent),f=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(i.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(o)))).state={pubs:{},latitude:null,longitude:null,accuracy:null},n}return Object(s.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){var n=e.coords;t.setState({latitude:n.latitude,longitude:n.longitude,accuracy:n.accuracy});var a=n.latitude-.4,o=n.longitude-.4,c=n.latitude+.4,r=n.longitude+.4;(function(t){return new Promise((function(e,n){return fetch("https://overpass.openstreetmap.fr/api/interpreter?data=[out:json];node[amenity=pub](".concat(t,");out;")).then((function(t){return t.json()})).then((function(t){return e(d()(t))})).catch((function(t){return n(t)}))}))})("".concat(a,",").concat(o,",").concat(c,",").concat(r)).then((function(e){return t.setState({pubs:e})})).catch((function(t){return console.error(t)}))}),(function(t){return console.error(t)}))}},{key:"render",value:function(){var t=this.state,e=t.pubs,n=t.longitude,a=t.latitude,c=t.accuracy;return 0===Object.values(e).length?o.a.createElement("h2",{style:{width:"100px",margin:"auto"}},"loading..."):o.a.createElement(v,{pubs:e,center:[n,a],accuracy:c})}}]),e}(a.PureComponent);Object(c.render)(o.a.createElement(f,null),document.getElementById("app"))}},[[10,1,2]]]);
//# sourceMappingURL=main.f9975585.chunk.js.map